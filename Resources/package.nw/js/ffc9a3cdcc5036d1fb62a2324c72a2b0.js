;!function(require, directRequire){;"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const projectManager=require('./3bfffbe88b3d923921f851c0697974fe.js'),tokenmanager_1=require('./dc244a5ba483ad6e0acd267d3b91b282.js');let websocketHeader;const handler=(a)=>{const{type:b,url:c}=a;if("websocket"===b&&0!==c.indexOf(`ws://127.0.0.1:${global.messageCenterPort}`)){const b=a.requestHeaders||[];if(websocketHeader){for(const a in websocketHeader)b.push({name:a,value:websocketHeader[a]});exports.setWebSocketHeader(void 0)}const c=projectManager.getProjectAppID();return b.push({name:"Referer",value:`https://servicewechat.com/${c}/devtools/page-frame.html`}),{requestHeaders:b}}if(0===c.indexOf(`http://127.0.0.1:${global.proxyPort}`)){const b=a.requestHeaders||[];for(const a of b)if("user-agent"===a.name.toLowerCase()){const b=tokenmanager_1.tokenManager.getSessionToken(tokenmanager_1.validType.UA_TOKEN);a.value+=` token/${b}`}return{requestHeaders:b}}};exports.setWebSocketHeader=(a)=>{websocketHeader=a},exports.addListener=()=>{chrome.webRequest.onBeforeSendHeaders.addListener(handler,{urls:["<all_urls>"]},["blocking","requestHeaders"])},exports.removeListener=()=>{chrome.webRequest.onBeforeSendHeaders.removeListener(handler)};
;}(require("lazyload"), require);
