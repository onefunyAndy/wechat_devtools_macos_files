'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){function a(a,b){let c=new Error(a);throw c.code=b,c}function b(b,c){'string'!=k.getType(b)&&a(l.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'string']),s.APP_JSON_CONTENT_ERR),0<=b.indexOf('\\')&&a(l.config.JSON_SHOULD_NOT_CONTAIN.format([`${c}`,'\\']),s.APP_JSON_CONTENT_ERR),0==b.indexOf('.')&&a(l.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'.']),s.APP_JSON_CONTENT_ERR),0==b.indexOf('/')&&a(l.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'/']),s.APP_JSON_CONTENT_ERR)}function c(a,b){function c(b,c){return'object'==k.getType(b)?'string'==k.getType(b.provider)?'string'==k.getType(b.version)?a.compileType!=m.plugin&&'dev'==b.version?void d.push(l.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${c}.version`,'dev'])+'\n'+l.config.PLEASE_CHOOSE_PLUGIN_MODE):a.compileType==m.plugin&&'dev'==b.version&&b.provider!=a.appid?void d.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,a.appid])):'dev'==b.version||/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(b.version)||void d.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,l.config.TRIPLE_NUMBER_DOT])):void d.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,'string'])):void d.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,'string'])):void d.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'object']))}const d=[],e=b.plugins;if(!e)return d;if('object'!=k.getType(e))return d.push(l.config.JSON_CONTENT_SHOULD_BE.format(['plugins','object'])),d;const f={};for(const g in e){const a=e[g];c(a,`plugins.${g}`)&&(f[a.provider]?d.push(l.config.PLUGINS_MULTI_PROVIDER.format(a.provider)):f[a.provider]={provider:a.provider,version:a.version,alias:g})}if(b.subPackages&&b.subPackages.forEach((a,b)=>{if(a.plugins)for(const g in a.plugins){const h=a.plugins[g];(e[g]&&d.push(l.config.JSON_PLUGIN_SHOULD_NOT_IN_SUBPACKAGE.format([`plugins ${g}`,`subPackages[${b}]`])),!!c(h,`subPackages[${b}].plugins.${g}`))&&(f[h.provider]?d.push(`subPackages[${b}].plugins['${g}'].provider ${l.config.ALREADY_EXISTS}`):f[h.provider]={provider:h.provider,version:h.version,alias:h})}}),0<d.length){const a=new Error(d.join('\n'));throw a.code=s.APP_JSON_CONTENT_ERR,a}}function d(c,d){let e='subPackages';d.subpackages&&(e='subpackages',d.subPackages=d.subpackages,delete d.subpackages);const f=d.pages||[];let g=!1;if(d.subPackages){'array'!=k.getType(d.subPackages)&&a(l.config.JSON_CONTENT_SHOULD_BE.format([e,'array']),s.APP_JSON_CONTENT_ERR);const i={},m={},n=[];d.subPackages.forEach((a,o)=>{if(b(a.root,`${e}[${o}].root`),a.root===p.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void n.push(l.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${e}[${o}].root`,p.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(a.name){if('string'!==k.getType(a.name))return void n.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].name`,'string']));if(a.name===p.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void n.push(l.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${e}[${o}].name`,p.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(m[a.name])return void n.push(l.config.JSON_SUBPACKAGE_EXIST.format([`${e}[${o}].name`]));m[a.name]=!0}if(a.root=k.normalizePath(a.root+'/'),i[a.root])return void n.push(l.config.JSON_SUBPACKAGE_EXIST.format([`${e}[${o}].root`]));if(i[a.root]=!0,!j.existsSync(h.join(c,a.root)))return void n.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].root`,l.config.DIRECTORY]));const q=j.statSync(h.join(c,a.root));if(!q.isDirectory())return void n.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].root`,l.config.DIRECTORY]));if(f.forEach((b)=>{0==b.indexOf(a.root)&&n.push(l.config.JSON_PAGE_SHOULD_NOT_IN_SUBPACKAGE.format([`pages ${b}`,`${e}[${o}]`]))}),'array'!=k.getType(a.pages))return void n.push(l.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].pages`,'array']));const r={};for(let f=0,i=a.pages.length;f<i;f++){const i=a.pages[f];b(i,`${e}[${o}].pages[${f}]`);const m=k.normalizePath(h.posix.join(a.root,i));if(r[m]){n.push(l.config.JSON_PAGES_REPEAT.format([`${e}[${o}]`,i]));continue}r[m]=!0,g||m!=d.entryPagePath||(g=!0),j.existsSync(h.join(c,`${m}\.wxml`))||n.push(l.config.JSON_PAGE_WXML_NOT_EXISTS.format([`${e}[${o}]`,'pages',m])),j.existsSync(h.join(c,`${m}\.js`))||n.push(l.config.JSON_PAGE_JS_NOT_EXISTS.format([`${e}[${o}]`,'pages',m]))}}),0<n.length&&a(n.join('\n'),s.APP_JSON_CONTENT_ERR),d.subPackages.forEach((a,b)=>{let c=-1;const f='/'+a.root;if(d.subPackages.forEach((a,d)=>{if(d!=b&&a.root){const b='/'+a.root;0==f.indexOf(b)&&(c=d)}}),-1!=c)return void n.push(l.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${e}[${b}].root`,`${e}[${c}].root 的子目录`]))}),0<n.length&&a(n.join('\n'),s.APP_JSON_CONTENT_ERR)}return g}function e(b){if(b.preloadRule&&b.subPackages){'object'!==k.getType(b.preloadRule)&&a(l.config.JSON_CONTENT_SHOULD_BE.format(['preloadRule','object']),s.APP_JSON_CONTENT_ERR);let c=[],d=[].concat(b.pages),e={},f={};for(let a=0,c=b.subPackages.length;a<c;a++){const c=b.subPackages[a],g=c.pages.map((a)=>{return h.posix.join(c.root,a)});e[c.root]=!0,c.name&&(f[c.name]=!0),d=d.concat(g)}for(const a in b.preloadRule){if(-1===d.indexOf(a)){c.push(l.config.NOT_FOUND.format(`preloadRule['${a}'] ${l.config.PAGE_PATH}`));continue}const g=b.preloadRule[a];if(g.network){if('string'!==k.getType(g.network)){c.push(l.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'string']));continue}if(-1===['all','wifi'].indexOf(g.network)){c.push(l.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'all/wifi']));continue}}if('array'!==k.getType(g.packages)){c.push(l.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].packages`,'array']));continue}for(let b,d=0,h=g.packages.length;d<h;d++)if((b=g.packages[d],b!==p.MINI_PROGRAM_MAIN_PACKAGE_ROOT)&&!f[b]&&(b=k.normalizePath(b+'/'),!e[b])){c.push(l.config.NOT_FOUND.format(`preloadRule['${a}'].packages[${d}]: ${b}`));continue}}0<c.length&&a(c.join('\n'),s.APP_JSON_CONTENT_ERR)}}async function f(c,d){const e=await n(c),f=e.srcPath,g=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),m=_extends({},g.setting,c.attr&&c.attr.setting),o=d.pages,p=d.tabBar;let q=[];if(p){'array'!=k.getType(p.list)&&a(l.config.JSON_TABBAR_SHOULD_BE_LIST,s.APP_JSON_CONTENT_ERR),p.list.length<m.MinTabbarCount&&a(l.config.JSON_TABBAR_AT_LEAST.format(m.MinTabbarCount),s.APP_JSON_CONTENT_ERR),p.list.length>m.MaxTabbarCount&&a(l.config.JSON_TABBAR_AT_MOST.format(m.MaxTabbarCount),s.APP_JSON_CONTENT_ERR);for(var t=0;t<p.list.length;t++){let a=p.list[t];if('object'!=k.getType(a)){q.push(l.config.JSON_TABBAR_ITEM_OBJECT.format(t));continue}const c=a.pagePath;if(b(c,`tabBar[${t}].pagePath`),!c){q.push(l.config.JSON_TABBAR_PATH_EMPTY.format(t));continue}if(0>o.indexOf(c)){q.push(`tabBar[${t}].pagePath "${c}" 需在 pages 数组中`);continue}2<=c.split('?').length&&q.push(l.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([t,'?'])),2<=c.split('.').length&&q.push(l.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([t,'.']));let d=[];if(a.iconPath){let b=h.join(f,a.iconPath);a.iconPath=h.relative(f,b),d.push({name:'iconPath',path:b})}if(a.selectedIconPath){let b=h.join(f,a.selectedIconPath);a.selectedIconPath=h.relative(f,b),d.push({name:'selectedIconPath',path:b})}d.forEach((a)=>{if(!j.existsSync(a.path))return q.push(l.config.JSON_TABBAR_ICON_NOT_FOUND.format([t,a.name]));let b=j.statSync(a.path);if(b.isDirectory())return q.push(l.config.JSON_TABBAR_ICON_NOT_DIR.format([t,a.name]));b.size>1024*m.MaxTabbarIconSize&&q.push(l.config.JSON_TABBAR_ICON_MAX_SIZE.format([t,a.name,m.MaxTabbarIconSize]));let c=h.extname(a.path);0>r.indexOf(c)&&q.push(l.config.JSON_TABBAR_ICON_EXT.format([t,a.name,r.join('\u3001')]))})}}0<q.length&&a(q.join('\n'),s.APP_JSON_CONTENT_ERR)}async function g(g){const o=await n(g),p=o.srcPath,r=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),t='app.json';let u='',v=[];try{u=o.getFile(t)}catch(a){const b=new Error(l.config.FILE_NOT_FOUND.format(t));throw b.code=s.APP_JSON_READ_ERR,b.ext=a.toString(),b}let w={};try{w=JSON.parse(u)}catch(b){const c=q.parseJsonParseErr({data:u,error:b});a(c,s.APP_JSON_PARSE_ERR)}'string'==k.getType(w.entryPagePath)&&b(w.entryPagePath,'entryPagePath');const x=w.pages||[];('array'!=k.getType(x)||0===x.length)&&a(l.config.ENTRANCE_NOT_FOUND.format(JSON.stringify(x)),s.APP_JSON_ENTRANCE_NOT_FOUND_ERR);let y=!w.entryPagePath;const z={};for(let c=0;c<x.length;c++){const d=x[c];b(d,`pages[${c}]`),z[d]&&a(l.config.JSON_PAGES_REPEAT.format([t,d]),s.APP_JSON_PAGES_ERR),z[d]=!0,y||d!=w.entryPagePath||(y=!0),j.existsSync(h.join(p,`${d}\.wxml`))||a(l.config.JSON_PAGE_WXML_NOT_EXISTS.format([t,'pages',d]),s.APP_JSON_WXML_NOT_FOUND),j.existsSync(h.join(p,`${d}\.js`))||a(l.config.JSON_PAGE_JS_NOT_EXISTS.format([t,'pages',d]),s.APP_JSON_JS_NOT_FOUND)}await f(g,w);const A=g.compileType;if(A==m.conversation||A==m.search){const a=w.widgets;let b,c='';if(!a)b=new Error(l.config.JSON_WIDGETS_EMPTY.format('app.json'));else if('array'!=k.getType(a))b=new Error(l.config.JSON_WIDGETS_NOT_ARRAY.format('app.json'));else{const d=[];a.forEach((a,b)=>{if('object'!=k.getType(a))d.push(l.config.JSON_WIDGETS_ITEM_NOT_OBJECT.format(['app.json',b]));else if('conversation'!=a.type&&'search'!=a.type)d.push(l.config.JSON_WIDGETS_TYPE_INVALID.format(['app.json',b,'conversation\u3001search']));else if(!a.path||'string'!=k.getType(a.path))d.push(l.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else if(!j.existsSync(h.join(p,a.path)))d.push(l.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else{const c=j.statSync(h.join(p,a.path));c.isDirectory()?!j.existsSync(h.join(p,a.path,'widget.js'))&&d.push(l.config.JSON_WIDGETS_JS_NOT_FOUND.format(['app.json',b,'widget.js'])):d.push(l.config.JSON_WIDGETS_PATH_SHOULD_BE_DIR.format(['app.json',b]))}c||a.type!=g.compileType||(c=a.path)}),c||d.push(l.config.JSON_WIDGETS_TYPE_NOT_FOUND.format(['app.json',g.compileType])),0<d.length&&(b=new Error(d.join('\n')))}if(b)throw b.code=s.APP_JSON_CONTENT_ERR,b}const B=await i(g);if(B)for(const a in B)'extPages'!=a&&(w[a]='object'==k.getType(B[a])?Object.assign({},w[a]||{},B[a]):B[a]);const C=d(p,w);return y=y||C,y||a(l.config.JSON_ENTRY_PAGE_PATH_NOT_FOUND.format(['pages\u3001subPackages','entryPagePath']),s.APP_JSON_PAGES_ERR),c(g,w),e(w),w.window&&(v=[],['enablePullDownRefresh'].forEach((a)=>{'undefined'!=typeof w.window[a]&&'boolean'!=typeof w.window[a]&&v.push(l.config.JSON_CONTENT_SHOULD_BE.format([a,'boolean']))}),w.window.backgroundColorTop&&(w.window.backgroundColor=w.window.backgroundColorTop)),0<v.length&&a(v.join('\n'),s.APP_JSON_CONTENT_ERR),w}const h=require('path'),j=require('fs'),k=require('./84b183688a46c9e2626d3e6f83365e13.js'),l=require('./common/locales/index.js'),i=require('./551bb965e1f344281d555a429cd2140c.js'),m=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),n=require('./162bf2ee28b76d3b3d95b685cede4146.js'),o=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),p=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),q=require('./6238a86bb7a55c11aa0f9eb335d0f34c.js'),r=['.png','.jpg','.jpeg'],s=require('./949d8235c744ced2a80121e4dba34c28.js');module.exports=async function(a){try{return await g(a)}catch(a){throw a.code||(a.code=s.APP_JSON_CONTENT_ERR),a}}}(require('lazyload'),require);