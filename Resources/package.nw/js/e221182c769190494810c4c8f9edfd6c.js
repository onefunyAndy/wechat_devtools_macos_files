'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){const a=require('path'),b=require('fs'),c=require('lodash'),{REHYDRATE:d}=require('redux-persist/constants'),e=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),f=require('./84858de8a097c9cf84ff2c2e3d86e2a9.js'),g=require('./72653d4b93cdd7443296229431a7aa9a.js'),h=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),i=require('./92320c1386e6db6a6f2556736a9bc280.js'),j=require('./d28a711224425b00101635efe1034c99.js'),k=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),l=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),m=require('./881e653f19d837f2408386047cb8c38c.js'),n=require('./f7f00c29d59ec60edc211efe68c159c4.js'),{default_weapp_header:o}=require('./5498e660c05c574f739a28bd5d202cfa.js'),p=(a)=>{if(void 0===a.attr&&(a.attr={}),void 0===a.condiction&&(a.condiction={weapp:{current:-1,list:[]},search:{current:-1,list:[]},conversation:{current:-1,list:[]}}),void 0===a.condiction.game&&(a.condiction.game={current:-1,list:[]}),void 0===a.condiction.plugin&&(a.condiction.plugin={current:-1,list:[]}),void 0===a.compileType&&(a.compileType='weapp'),void 0===a.setting&&(a.setting={urlCheck:!0,es6:!0,postcss:!0,minified:!0}),void 0===a.scripts&&(a.scripts={}),a.appid){const b=f.getTcb(a.appid)||{};a.tcb=_extends({envList:[],currentEnv:{},functionData:{},command:{},scfMapInEnv:{},fileMapInEnv:{}},b)}},q=()=>{let a,b=f.lastSelect;return b=global.isDevWindow?'miniprogram'===global.devType?global.devInfo.projectid:k.MAIN_WINDOW_TYPE.WEB_DEBUGGER:null,f.projectList[b]?(a=f.projectList[b],a&&a.qcloud&&delete a.qcloud,p(a),a.storage={},a.libVersion=j.setVersion(a.libVersion)):b===k.MAIN_WINDOW_TYPE.WEB_DEBUGGER?a=null:global.isDevWindow&&(global.devInfo.isTemp?a=global.devInfo.project:(console.error(global.devInfo),m.notifyCloseWindow(!0))),{current:a,list:f.projectList}};module.exports=function(h=q(),k={}){switch(k.type){case e.PROJECT_SET_PROJECT_CONFIG:return _extends({},h,{current:_extends({},h.current,k.data)});case e.PROJECT_CREATE_PROJECT_SUCCESS:return _extends({},h,{list:_extends({},h.list,{[k.project.projectid]:k.project})});case e.PROJECT_UPDATE_LIST:return _extends({},h,{list:k.list});case e.PROJECT_UPDATE_ATTR:{const a=_extends({},h.current),b=k.data,c=b.appid;return a.attr=_extends({},a.attr,b),b.userbanded&&(a.appShowName=b.appName,a.appShowImageUrl=b.appImageUrl||o,c==a.appid?(a.attr.appName=b.appName,a.attr.appImageUrl=b.appImageUrl):a.attr.extInfo=_extends({},a.attr.extInfo,{appName:b.appName,appImageUrl:b.appImageUrl})),b.gameApp&&a.compileType!=l.conversation&&a.compileType!=l.search&&(a.compileType=l.game),_extends({},h,{current:a})}case e.PROJECT_OPEN_PROJECT:{const a=h.list[k.projectid];if(!a)return g.error(`project.reducer.js trying open a project with unknown projectid: ${k.projectid}`),h;return a.qcloud&&delete a.qcloud,p(a),a.libVersion=j.setVersion(a.libVersion),_extends({},h,{current:a})}case e.PROJECT_OPEN_TEMP_PROJECT:return _extends({},h,{current:k.project,list:_extends({},h.list,{[k.project.projectid]:k.project})});case e.PROJECT_SET_COMPILE_CONDICTION:{const a=h.current.compileType,b=h.current.condiction[a]||{},c=[].concat(b.list||[]),d=-1==k.data.id?c.length:k.data.id;return c[d]=_extends({},k.data),_extends({},h,{current:_extends({},h.current,{condiction:_extends({},h.current.condiction,{[a]:{current:d,list:c}})})})}case e.PROJECT_SELECT_COMPILE_CONDICTION:{const a=h.current.compileType,b=h.current.condiction[a]||{};return _extends({},h,{current:_extends({},h.current,{condiction:_extends({},h.current.condiction,{[a]:_extends({},b,{current:k.current})})})})}case e.PROJECT_REMOVE_COMPILE_CONDICTION:{const a=k.data.id,b=h.current.compileType,c=h.current.condiction[b]||{},d=[].concat(c.list||[]);return d.splice(a,1),_extends({},h,{current:_extends({},h.current,{condiction:_extends({},h.current.condiction,{[b]:{current:-1,list:d}})})})}case e.PROJECT_CHANGE_APPID:return _extends({},h,{current:_extends({},h.current,{appid:k.data.appid,projectid:k.data.projectid,attr:{}})});case e.PROJECT_SET_SETTING:return _extends({},h,{current:_extends({},h.current,{setting:_extends({},h.current.setting,k.data)})});case e.PROJECT_SET_LIBVERSION:return _extends({},h,{current:_extends({},h.current,{libVersion:k.data})});case e.PROJECT_SET_STORAGE:{const c=k.data.openid,d=k.data.cache,e=`${h.current.hash}_${c}`;try{const c=a.join(i.WeappStorage,`${e}.json`);b.writeFileSync(c,JSON.stringify(d),'utf8')}catch(a){return h}return _extends({},h,{current:_extends({},h.current,{storage:{openid:c,cache:d}})})}case e.PROJECT_SET_COMPILE_TYPE:return _extends({},h,{current:_extends({},h.current,{compileType:k.data})});case e.PROJECT_SET_QCLOUD:{const a=h.current.qcloud||{};return _extends({},h,{current:_extends({},h.current,{qcloud:_extends({},a,k.data)})})}case e.PROJECT_SET_PKG_SIZE:{let a=h.current.pkgSize||{};return a=_extends({},a,k.data),_extends({},h,{current:_extends({},h.current,{pkgSize:a})})}case e.PROJECT_SET_PLUGIN_INFO:return _extends({},h,{current:_extends({},h.current,{pluginInfo:k.data||[]})});case e.PROJECT_CLOSE_PROJECT:return _extends({},h,{current:null});case e.PROJECT_REMOVE_PROJECT:{const a={};return h.current&&h.current.id===k.id&&(a.current=null),a.list=_extends({},h.list),delete a.list[k.id],_extends({},h,a)}case e.PROJECT_SET_EXT_INFO:return _extends({},h,{current:_extends({},h.current,{attr:_extends({},h.current.attr,{extInfo:_extends({},k.data)})})});case e.PROJECT_SET_UPLOAD_INFO:return _extends({},h,{current:_extends({},h.current,{uploadInfo:_extends({},h.current.uploadInfo,k.data)})});case e.PROJECT_SET_SHARE_INFO:return _extends({},h,{current:_extends({},h.current,{shareInfo:_extends({},h.current.shareInfo,k.data)})});case e.PROJECT_SYNC_STORE:return _extends({},h,{list:k.data.list,syncTime:k.syncTime});case e.PROJECT_SET_SCRIPTS:return _extends({},h,{current:_extends({},h.current,{scripts:_extends({},h.current.scripts,k.data)})});case e.PROJECT_SET_TCBFN_ROOT:return _extends({},h,{current:_extends({},h.current,{cloudfunctionRoot:k.data})});case e.PROJECT_SET_TIME_RECORDS:return _extends({},h,{current:_extends({},h.current,{timeRecords:_extends({},h.current.timeRecords,k.data)})});case d:return c.merge(c.cloneDeep(h),k.payload.project);default:{if(h.current){const a=n(h.current.tcb,k);if(h.current.tcb!==a)return f.setTcb(h.current.appid,a),_extends({},h,{current:_extends({},h.current,{tcb:a})})}return h}}}}(require('lazyload'),require);