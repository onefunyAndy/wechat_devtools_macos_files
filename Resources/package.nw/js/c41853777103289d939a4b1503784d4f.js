'use strict';!function(require,directRequire){function a(a){const b=a.headers.host,d=!a.connection.encrypted||/^http:/.test(a.url)?'http':'https',e='http'==d?a.url:d+'://'+b+a.url,f=c.parse(e);return f.pureHref=f.href.replace(/\?.*/,'').replace(/\#.*/,''),f}function b(a){const b=a.headers['user-agent']||'',c=b.match(/token\/(\S*)/);return c&&c[1]&&C.validateSessionToken(c[1],B.UA_TOKEN)}const c=require('url'),d=require('path'),e=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),f='https://clients1.google.com/tbproxy/af/',g='http://aboutblank',{weappURLRegular:h,weappASURLRegular:i,weappLocalIdRegular:j,weappEditorServiceRegular:k,weappPluginServiceRegular:l,weappWidgetPageRegular:m,weappWidgetServiceRegular:n,weappGamePageRegular:o,weappTraceRegular:p,weappUsrFileReqular:q,weappStoreFileReqular:r,weappTmpFileReqular:s,weappUsrFilePathPrefix:t,weappTmpFilePathPrefix:u,weappStoreFilePathPrefix:v}=e,w=require('./3bfffbe88b3d923921f851c0697974fe.js'),x=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),y=require('./730f2a99f4d5cff2946dd0a3bad0a600.js'),z=require('./07af6655c180a0694f993b79d5b077df.js'),A=require('./f5a748840b272d2bf0223c95f6c8dbe3.js'),{validType:B,tokenManager:C}=require('./dc244a5ba483ad6e0acd267d3b91b282.js');module.exports={forceLocalProxy:[h,i,j,g,f,k,l,m,n,o,p,q,r,s],dealLocalResponse(c,e,h){if(!b(c))return h(403,{},'');const i=a(c),k=i.pureHref;if(0==k.indexOf('/appservice'))return void y.getAppServiceSource(k).then((a)=>{h(200,{},a)}).catch(()=>{h(404,{},'')});if(0==k.indexOf('/calibration'))return void h(200,{},'');if(0==k.indexOf('/__pageframe__')){const a=i.href;return void y.getWebviewSource(a).then((b)=>{const c={};'.svg'===d.extname(a)&&(c['Content-Type']='image/svg+xml'),h(200,c,b)}).catch(()=>{h(404,{},'')})}if(0==k.indexOf('/editor'))return void y.getEditorSource(k).then((a)=>{h(200,a.headers||{},a.body)}).catch(()=>{h(404,{},'')});if(0==k.indexOf('/trace'))return void z.getTraceRoute(i,(a,b)=>{a?h(500,{},JSON.stringify(a.message)):h(200,{},JSON.stringify(b))});if(0==k.indexOf('/widgetwebview'))return void y.getWidgetWebviewResource(k).then((a)=>{h(200,{},a)}).catch(()=>{h(404,{},'')});if(0==k.indexOf('/widgetservice'))return void y.getWidgetServiceResource(k).then((a)=>{h(200,{},a)}).catch(()=>{h(404,{},'')});if(0==k.indexOf('/game'))return void y.getGamePageResource(k).then((a)=>{h(200,{},a)}).catch((a)=>{h(404,{},a.toString())});if(0==k.indexOf('/aboutblank'))return void h(200,{},'');if(0==k.indexOf('/favicon.ico'))return void h(200,{},'');if(0===k.indexOf(f))return void h(400,{},'');if(0===k.indexOf(g))return void h(200,{},'');if(j.test(k)||0===k.indexOf('http://'+u+'/')||0===k.indexOf('http://'+v+'/')||0===k.indexOf('http://'+t+'/')||0===k.indexOf('/'+u+'/')||0===k.indexOf('/'+v+'/')||0===k.indexOf('/'+t+'/'))return void y.getLocalIdResponse(k.replace(j,'wxfile://')).then((a)=>{h(200,{},a)}).catch(()=>{h(404,{},'')});if(o.test(k))return void y.getGamePageResource(k).then((a)=>{h(200,{},a)}).catch((a)=>{h(404,{},a.toString())});if(0===k.indexOf('/'+t))return void y.getUsrFileResponse(k).then((a)=>{h(200,{},a)}).catch(()=>{h(404,{},'')});if(0==k.indexOf('/ideplugin')||l.test(k)){let a=k.match(/.*?\/ideplugin\/([^\/]*)\//);if(!a)return void h(404,{},'');const b=a[1],c=k.replace(/.*?\/ideplugin\/([^\/]*)\//,'');return'devtools'==b?void A.getDevtoolsManifest().then((a)=>{h(200,{},a)}).catch(()=>{h(404,{},'')}):void A.getFile(b,c).then((a)=>{const b={};'.svg'===d.extname(c)&&(b['Content-Type']='image/svg+xml'),h(200,b,a)}).catch(()=>{h(404,{},'')})}0===k.indexOf('/experience')&&y.getExperienceResource(k).then((a)=>{h(200,{},a)}).catch((a)=>{h(404,{},a.toString())})}}}(require('lazyload'),require);