;!function(require, directRequire){;"use strict";const React=require("react"),react_redux_1=require("react-redux"),contextmenu_1=require('./63b51d67a9665bc74cc0a77e00c26197.js'),toolbarActions=require('./fc137838572a83604db39acff8e909e0.js'),infoActions=require('./1fcc6bd55b687d154a4247e57fe3011d.js'),tools=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),locales=require('./common/locales/index.js'),C=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),ms=require('./ff946754202ecf377034d29daac7c8d9.js'),path=require("path"),scaleList=[{name:"100%",value:1},{name:"85%",value:0.85},{name:"75%",value:0.75},{name:"50%",value:0.5}];function mapStateToProps(a,b){const c=a.toolbar.device||{},d=a.toolbar.deviceScale;let e=-1;scaleList.forEach((a,b)=>{a.value==d&&(e=b)});const f=a.toolbar.network,g=f.list.map((a)=>C.NETWORK_STATUS_DISPLAY[a]||a),h=a.simulator,i=h.scene,j=h.currentWebviewID,k=h.webviewInfos,l=k&&k[j]||{},m=l.pathName||"",n=[],o=a.project,p=(o.current||{}).miniprogramRoot||"";for(const c in l.query)n.push(`${c}=${l.query[c]}`);return{context:b.context,type:b.type,showTs:b.showTs,location:b.location,deviceList:c.list,deviceCurrent:c.current,scaleList,scaleCurrent:e,networkList:g,networkCurrent:f.current,info:{scene:i,pathName:m,query:n.join("&"),sceneMap:a.config.sceneMap||[],clientPath:p}}}function mapDispatchToProps(a){return{onSelectDeviceClick:tools.bindActionCreators(toolbarActions.selectDevice,a),removeDevice:tools.bindActionCreators(toolbarActions.removeDevice,a),setAddDevicePopUp:tools.bindActionCreators(infoActions.setAddDevicePopUp,a),onSelectScaleClick(b){a(toolbarActions.setDeviceScale(scaleList[b].value))},onSelectNetworkClick:tools.bindActionCreators(toolbarActions.selectNetwork,a),showSuccessTip:tools.bindActionCreators(infoActions.showSuccessTip,a)}}class ToolbarContextMenu extends React.Component{constructor(a){super(a),this.state={}}componentWillReceiveProps(a){a.showTs>this.props.showTs&&0<a.showTs&&this.showContextMenu(a)}showContextMenu(a){const b=a.location||{left:0,top:0};let c;switch(a.type){case"device":c=this.getDevices(a);break;case"devicescale":c=this.getScales(a);break;case"network":c=this.getNetworks(a);break;case"device+network":c=(()=>{const b=this.getNetworks(a),c=this.getDevices(a),d=a.deviceList[a.deviceCurrent]||{};return[{title:d.name||"?",subItems:c},{title:a.networkList[a.networkCurrent]||a.networkCurrent,subItems:b}]})();break;case"pageinfo":c=this.getInfos(a);}if(c){let a=nw;if(this.props.context)try{a=this.props.context.window.window.nw}catch(b){console.log(b),a=nw}contextmenu_1.showContextMenu(c,b,a||nw)}}componentDidMount(){const a=this.props;0<a.showTs&&this.showContextMenu(a)}onSelectDeviceClick(a){this.props.onSelectDeviceClick(a)}onRemoveDeviceClick(a){this.props.removeDevice(a)}onAddDeviceClick(){this.props.setAddDevicePopUp({show:!0})}render(){return React.createElement("i",{"data-data-toolbarcontextmenu-placeholder":!0})}copyHelper(a){const b=nw.Clipboard.get();b.set(a),this.props.showSuccessTip(locales.config.CONSOLE_COPY_SUCCESS)}handlePathOpenClick(a){const b=a.info;ms.sendMessage("EDITOR",JSON.stringify({type:"COMMAND",command:"openFile",data:{path:("/"+path.posix.join(b.clientPath,(b.pathName||"")+".js")).replace(/\/+/g,"/")}}))}getInfos(a){const b=[],c=a.info;return b.push({title:locales.config.PAGE_PATH,disabled:!0}),b.push({title:c.pathName?c.pathName:`(${locales.config.EMPTY})`,disabled:!0,paddingLeft:2}),b.push({title:locales.config.COPY,paddingLeft:2,onClick:()=>{this.copyHelper(c.pathName+"")}},{title:locales.config.OPEN,paddingLeft:2,onClick:()=>{this.handlePathOpenClick(a)}}),b.push({isSeparator:!0}),b.push({title:locales.config.SCENE_VALUE,disabled:!0}),b.push({title:(c.scene?c.scene:`(${locales.config.EMPTY})`)+(c.scene?": "+c.sceneMap[c.scene]||"":""),disabled:!0,paddingLeft:2}),b.push({isSeparator:!0}),b.push({title:locales.config.PAGE_PARAMETERS,disabled:!0}),b.push({title:c.query?c.query:`(${locales.config.EMPTY})`,disabled:!0,paddingLeft:2}),c.query&&b.push({title:locales.config.COPY,onClick:()=>{this.copyHelper(c.query+"")},paddingLeft:2}),b}getNetworks(a){return a.networkList.map((b,c)=>{return{title:b,onClick:()=>a.onSelectNetworkClick(c),checked:a.networkCurrent===c,disabled:a.networkCurrent===c}})}getScales(a){return a.scaleList.map((b,c)=>{return{title:b.name,onClick:()=>this.props.onSelectScaleClick(c),disabled:c===a.scaleCurrent,checked:c===a.scaleCurrent}})}getDevices(a){const b=[],{deviceList:c,deviceCurrent:d}=a,e=[];if(c.forEach((a,c)=>{0!==c&&"default"!=a.type&&b.push({isSeparator:!0}),b.push({title:a.name+"  ("+a.desc+")",onClick:()=>this.onSelectDeviceClick(c),checked:c===d,disabled:c===d}),"custom"===a.type&&e.push({item:a,index:c})}),b.push({isSeparator:!0}),b.push({title:locales.config.CUSTOM,onClick:()=>this.onAddDeviceClick()}),0<e.length){b.push({isSeparator:!0});const a=[];e.forEach((b)=>{a.push({title:b.item.name,onClick:()=>this.onRemoveDeviceClick(b.index)})}),b.push({title:locales.config.DELETE,subItems:a})}return b}}module.exports=react_redux_1.connect(mapStateToProps,mapDispatchToProps)(ToolbarContextMenu);
;}(require("lazyload"), require);
