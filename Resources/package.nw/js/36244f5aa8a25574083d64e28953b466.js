'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){const a=require('lodash'),b=require('request'),c=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),d=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),e=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),f=require('./84858de8a097c9cf84ff2c2e3d86e2a9.js'),g=require('./cc2c2970ff81ae4a83123e81ee123da2.js'),h=require('./3bfffbe88b3d923921f851c0697974fe.js'),i=require('./ba23d8b47b1f4ea08b9fd49939b9443f.js'),j=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),k=require('./d28a711224425b00101635efe1034c99.js'),l=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),m=require('./551bb965e1f344281d555a429cd2140c.js'),n=require('./5719b6ded53098ffd9e848abcac30153.js'),o=require('./5eb00762b104199e0cf0af7efbe591da.js'),p={network:{RequestDomain:[],WsRequestDomain:[],UploadDomain:[],DownloadDomain:[]},setting:_extends({},l.setting)},q=()=>{try{const a=c.getState();a.window.simulator.show||c.dispatch({type:d.WINDOW_TOGGLE_SIMULATOR}),a.window.debug.show||c.dispatch({type:d.WINDOW_TOGGLE_DEBUGGER})}catch(a){}},r=(b,d,e,i={})=>new Promise(async(l,q)=>{let r;d.projectname&&(d.projectname=encodeURIComponent(decodeURIComponent(d.projectname)));try{let s=!1;if(!i.isTemp){const a=f.projectList,b=`${d.appid}_${d.projectname}`;for(const c in a)if(c==b){r=a[c],s=!0;break}}if(s)r.projectpath!==e&&q(n.ERROR.DUPLICATE_PROJECT_ID());else{const f=`${d.appid}_${d.projectname}`;r=_extends({},d,{isAdmin:b.is_admin,isTourist:!1,isTemp:i.isTemp,isOnline:i.isOnline,urlCheck:!0,projectid:f,hash:j.strToHash(f),appid:d.appid,projectname:d.projectname,projectpath:e,appShowImageUrl:'',libVersion:k.getVendorConfig().currentLibVersion,attr:_extends({},p,{platform:!!b.is_platform,platformNickname:b.platform_nickname||'',appNickName:''})});const l=a.merge(h.projectConfigDefault(r),r);r=l,r.compileType||(r.compileType='weapp');let n;try{if(n=await o.getAppAttr(r),r.attr=_extends({},r.attr,n),b.is_platform){const a=await m(r);a&&a.extAppid&&(r.attr.extInfo={appid:a.extAppid})}}catch(a){q(a)}i.isTemp?localStorage[`temp_${r.projectid}`]=JSON.stringify(r):c.dispatch(g.createProjectSuccess(r))}l(r)}catch(a){q(n.ERROR.GENERIC_ERROR(a.toString()))}});module.exports={getProject:r,openProject:(a,b,d,e={})=>new Promise(async(f,h)=>{try{const h=await r(a,b,d,e),i=()=>{c.dispatch(g.openProject(h.projectid)).then(()=>{setTimeout(()=>{q()},20)})};if(e.isTemp)c.dispatch(g.openTempProject(h));else{const a=c.getState();a.project&&a.project.current?(c.dispatch(g.closeProject()),setTimeout(i,50)):i()}f()}catch(a){h(a)}}),isOpened:(a,b)=>{try{const d=c.getState().project.current;return d.projectid===a&&d.projectpath===b}catch(a){return!1}},openSimulatorAndDebugger:q,compile:()=>{try{c.dispatch(i.compile({origin:e.COMPILE_ORIGIN.HTTP}))}catch(a){}}}}(require('lazyload'),require);