'use strict';!function(require,directRequire){function a(a,e={}){const{srcFilePath:f,fileBuffer:g,destFilePath:i}=e,j=c.extname(f);if(m[j]){const a=k(g);if(void 0===a){const a=new Error(h.config.FILE_NOT_UTF8.format(f));throw a.code=l,a}}const n=c.dirname(i);d.sync(n),b.writeFileSync(i,g)}const b=require('fs'),c=require('path'),d=require('mkdir-p'),e=require('./162bf2ee28b76d3b3d95b685cede4146.js'),f=require('./a63026ab5a5a3c59a61a9749a18aa2ca.js'),g=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),h=require('./common/locales/index.js'),i=require('./d260ebf687a29f24aed49f66b233ab7d.js'),j=require('./dedcbe3bc309c536210de2a4e997918e.js'),{bufToUTF8:k}=require('./efc820e1b92d6e4063535296d4a24213.js'),{FILE_NOT_UTF8:l}=require('./949d8235c744ced2a80121e4dba34c28.js'),m={".json":!0,".wxml":!0,".wxs":!0},{whiteFileExtName:n,gameWhiteFileExtName:o}=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),p={".js":!0,".wxss":!0};module.exports=async function(d,h={}){const k=d.compileType,{distPath:l}=h;let m=await e(d),q=m.getAllFile(),r=n;d.attr&&d.attr.gameApp&&(r=o);let s=k==g.plugin?d.miniprogramRoot:'';for(let b=0,e=q.length;b<e;b++){const e=q[b],f=c.extname(e);if(!p[f]&&r[f]){if((!d.attr||!d.attr.platform||!d.attr.extInfo||!d.attr.extInfo.appid)&&'ext.json'===e)continue;let b=m.getFile(e,null);if('.json'===f&&!(d.attr&&d.attr.gameApp)&&'app.json'!=e){const a=await i(d,e.replace(/\.json$/,''));b=new Buffer(JSON.stringify(a),'utf8')}a(d,{fileBuffer:b,srcFilePath:c.join(s,e),destFilePath:c.join(l,s,e)})}}if(k==g.plugin){m=await f(d),q=m.getAllFile(),r=n,s=d.pluginRoot,d.attr&&d.attr.gameApp&&(r=o);for(let b=0,e=q.length;b<e;b++){const e=q[b],f=c.extname(e);if(!p[f]&&r[f]){let b=m.getFile(e,null);if('.json'===f&&'plugin.json'!=e){const a=await j(d,e.replace(/\.json$/,''));b=new Buffer(JSON.stringify(a),'utf8')}a(d,{fileBuffer:b,srcFilePath:c.join(s,e),destFilePath:c.join(l,s,e)})}}b.writeFileSync(c.join(l,'project.config.json'),JSON.stringify({miniprogramRoot:d.miniprogramRoot,pluginRoot:d.pluginRoot}))}b.existsSync(c.join(l,'project.config.json'))||b.writeFileSync(c.join(l,'project.config.json'),'{}')}}(require('lazyload'),require);